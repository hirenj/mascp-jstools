<html>
<head>
<script src="dist/js/mascp-jstools.js"></script>
</head>
<body>
	<div id="container" style="postion: absolute; width: 100%; height: 400px; top: 0px; overflow: hidden;"></div>
	<div style="padding: 30px;">
	<gator-uniprot style="width: 100%; height: 300px;" accession="q14118" caching="true"></gator-uniprot>
	<gator-gene style="width: 100%; height: 300px;" zoom="0.03" geneid="1605" accession="q14118" exonmargin="300" caching="true"></gator-gene>
	</div>
	<script>
		window.doProteome = function() {
			var up = 'q14118';
            var proxy_reader = {
                agi: up,
                gotResult: function() {
                	MASCP.registerLayer(up,{'fullname' : "foo"});
                	the_rend.addAxisScale('foo',function(aa) {  return aa * (window.scaleval || 1); });
                    // the_rend.getAA(100).addToLayer(up,1,{'fill' : '#000'});
                    var an_aa = the_rend.getAA(101);
                    console.log(an_aa);
                    an_aa.addToLayer(up,{'fill' : '#f00', 'height': 12 });
                    the_rend.trackOrder.push('q14118');
                    the_rend.showLayer('q14118');
                    the_rend.refresh();
                    // the_rend.getAA(200).addToLayer(up,1,{'fill' : '#000'});
                }
            };
            MASCP.Service.prototype.registerSequenceRenderer.call(proxy_reader,the_rend);
            proxy_reader.gotResult();
		};
		window.doGenome = function() {
			var reader = new MASCP.GenomeReader();
			reader.registerSequenceRenderer(the_rend);
			//p12830
			// var up = 'p02768';
			var up = 'q14118';
			reader.exon_margin = 300;
			reader.retrieve(up,function(err) {
				the_rend.zoom = 0.01;
				console.log(this.result);
	            var proxy_reader = {
	                agi: up,
	                gotResult: function() {
	                    // the_rend.getAA(100).addToLayer(up,1,{'fill' : '#000'});
	                	MASCP.registerLayer(up,{'fullname' : "prot"});
	                    var an_aa = the_rend.getAA(300);
	                    an_aa.addToLayer(up,{'fill' : '#f00', 'height': 12 });
	                    the_rend.trackOrder.push(up);
	                    the_rend.showLayer(up);

	                    // the_rend.getAA(200).addToLayer(up,1,{'fill' : '#000'});
	                }
	            };
	            MASCP.Service.prototype.registerSequenceRenderer.call(proxy_reader,the_rend);
	            proxy_reader.gotResult();


			});

		};
		MASCP.ready = function() {
			var renderer = new MASCP.CondensedSequenceRenderer(document.getElementById('container'));
			MASCP.Service.BeginCaching();
			(new MASCP.UniprotReader()).retrieve('q14118',function() {
				renderer.setSequence(this.result.getSequence());
			});
			renderer.bind('sequenceChange',function() {
				renderer.hideAxis();
				// window.doProteome();
			})
			renderer.refresh();
			renderer.grow_container = true;
			window.the_rend = renderer;
			window.doGenome();
		};
	</script>
</body>
</html>